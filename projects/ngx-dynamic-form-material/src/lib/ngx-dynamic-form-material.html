<form #ngForm="ngForm" nz-form [formGroup]="formGroup" (ngSubmit)="submit()">
    <div class="row">
        @for (field of form.formGroup; track field.formControlName; let i = $index) {
        <div class="col-md-{{ field.column ?? 12 }}" [formGroup]="formGroup">
            @if (field.fieldType !== 'checkbox' && field.fieldType !== 'radio' && field.fieldType !== 'switch' &&
            field.fieldType !== 'slider' && field.fieldType !== 'range' && field.fieldType !== 'file') {
            <mat-form-field class="field">
                <mat-label>{{ field.label }}</mat-label>
                @switch (field.fieldType) {
                @case ('input') {
                <input matInput [placeholder]="field.placeholder ?? ''" [value]="field.value"
                    [formControlName]="field.formControlName" [type]="field.inputType ?? 'text'"
                    [id]="field.formControlName" [required]="field.required ?? false" [class]="field.customClass" />
                }
                @case ('select') {
                <mat-select [formControlName]="field.formControlName" [id]="field.formControlName"
                    [required]="field.required ?? false" [class]="field.customClass"
                    [placeholder]="field.placeholder ?? ''">
                    @for (option of field.options; track option.value) {
                    <mat-option [disabled]="option.disabled" [value]="option.value">
                        {{ option.key }}
                    </mat-option>
                    }
                </mat-select>
                }
                @case ('textarea') {
                <textarea matInput [placeholder]="field.placeholder ?? ''" [value]="field.value"
                    [formControlName]="field.formControlName" [id]="field.formControlName"
                    [required]="field.required ?? false" [class]="field.customClass" [rows]="4"></textarea>
                }
                @case ('date') {
                <input matInput [matDatepicker]="picker" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
                }
                @case ('autocomplete') {
                <input type="text" matInput [formControlName]="field.formControlName" [matAutocomplete]="auto"
                    [placeholder]="field.placeholder ?? ''">
                <mat-autocomplete #auto="matAutocomplete">
                    @for (option of field.options; track option.value) {
                    <mat-option [value]="option.value">{{ option.key }}</mat-option>
                    }
                </mat-autocomplete>
                }
                @case ('time') { <input matInput type="time" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                @case ('datetime-local') { <input matInput type="datetime-local"
                    [formControlName]="field.formControlName" [placeholder]="field.placeholder ?? ''"> }
                @case ('month') { <input matInput type="month" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                @case ('week') { <input matInput type="week" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                @case ('tel') { <input matInput type="tel" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                @case ('url') { <input matInput type="url" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                @case ('email') { <input matInput type="email" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                @case ('search') { <input matInput type="search" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                @case ('color') { <input matInput type="color" [formControlName]="field.formControlName"
                    [placeholder]="field.placeholder ?? ''"> }
                }
            </mat-form-field>
            } @else {
            @switch (field.fieldType) {
            @case ('radio') {
            <mat-radio-group [formControlName]="field.formControlName" [id]="field.formControlName"
                [required]="field.required ?? false" [class]="field.customClass">
                @for (option of field.options; track option.value) {
                <mat-radio-button [disabled]="option.disabled" [value]="option.value">
                    {{ option.key }}
                </mat-radio-button>
                }
            </mat-radio-group>
            }
            @case ('checkbox') {
            @for (option of field.options; track option.value) {
            <mat-checkbox [formControlName]="field.formControlName" [id]="field.formControlName + '_' + option.value"
                [required]="field.required ?? false" [class]="field.customClass" [disabled]="option.disabled ?? false"
                [value]="option.value">
                {{ option.key }}
            </mat-checkbox>
            }
            }
            @case ('switch') {
            <mat-slide-toggle [formControlName]="field.formControlName" [class]="field.customClass">
                {{ field.label }}
            </mat-slide-toggle>
            }
            @case ('slider') {
            <label>{{ field.label }}</label>
            <mat-slider [class]="field.customClass">
                <input matSliderThumb [formControlName]="field.formControlName">
            </mat-slider>
            }
            @case ('range') {
            <label>{{ field.label }}</label>
            <mat-slider [class]="field.customClass">
                <input matSliderThumb [formControlName]="field.formControlName">
            </mat-slider>
            }
            @case ('file') {
            <label>{{ field.label }}</label>
            <input type="file" [id]="field.formControlName" [class]="field.customClass">
            }
            }
            }
            @for (validation of field.validations; track validation.name) {
            @if ((isTouched(field.formControlName) && hasError(field.formControlName, validation.name))) {
            <mat-error>{{ validation.message }}</mat-error>
            }
            }
        </div>
        }
    </div>

    <button type="submit" mat-button [class]="form.style.button.customClass" style="margin-top: 15px;">
        {{ form.style.button.name }}
    </button>

</form>